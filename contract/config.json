{
  "type": "object",
  "x-display": "expansion-panels",
  "x-options": {
    "expansionPanelsProps": {
      "multiple": true,
      "accordion": true,
      "value": [0]
    }
  },
  "allOf": [{
    "title": "Général",
    "required": ["themeColor"],
    "properties": {
      "title": {
        "type": "string",
        "default": "Portail de données"
      },
      "themeColor": {
        "type": "string",
        "default": "#1E88E5",
        "title": "Couleur principale",
        "x-display": "color-picker"
      },
      "datasetThumbnailContain": {
        "type": "boolean",
        "title": "Ne pas recadrer les images dans les vignettes de jeux de données",
        "default": false
      },
      "authentication": {
        "type": "string",
        "oneOf": [{
          "const": "none",
          "title": "Aucune, portail opendata"
        },{
          "const": "optional",
          "title": "Optionnelle pour voir les contenus protégés"
        },{
          "const": "required",
          "title": "Requise pour accéder au portail"
        }],
        "title": "Authentification",
        "default": "optional"
      },
      "assets": {
        "type": "object",
        "properties": {
          "logo": {
            "type": "object",
            "title": "Image du logo",
            "contentMediaType": "image/*",
            "writeOnly": true,
            "properties": {
              "name": {
                "type": "string"
              }
            }
          },
          "home": {
            "type": "object",
            "title": "Image principale",
            "contentMediaType": "image/*",
            "writeOnly": true,
            "properties": {
              "name": {
                "type": "string"
              }
            }
          },
          "favicon": {
            "type": "object",
            "title": "Favicon",
            "contentMediaType": "image/*",
            "writeOnly": true,
            "properties": {
              "name": {
                "type": "string"
              }
            }
          }
        }
      }
    }
  }, {
    "title": "Entête",
    "properties": {
      "website": {
        "type": "string",
        "title": "Site web accessible au clic sur le logo"
      },
      "headerSocial": {
        "type": "boolean",
        "title": "Montrer les liens de réseaux sociaux dans l'entête"
      },
      "headerLogo2": {
        "type": "string",
        "title": "Logo secondaire (affiché à droite de l'entête)",
        "description": "copiez l'url d'une image"
      },
      "headerLogo2Link": {
        "type": "string",
        "title": "Site web accessible au clic sur le logo secondaire"
      }
    }
  }, {
    "title": "Pied de page",
    "properties": {
      "footerColor": {
        "type": "string",
        "default": "#424242",
        "title": "Couleur du pied de page",
        "x-display": "color-picker"
      },
      "footerSocial": {
        "type": "boolean",
        "default": true,
        "title": "Montrer les liens de réseaux sociaux dans le pied de page"
      },
      "footerCopyrightAsLogo": {
        "type": "boolean",
        "default": false,
        "title": "Masquer le copyright du bas de page et le remplacer par un logo"
      },
      "footerLogo": {
        "type": "boolean",
        "title": "Afficher le logo principal dans le pied de page"
      },
      "footerLinksMode": {
        "type": "string",
        "default": "columns",
        "title": "Mode d'affichage des liens",
        "oneOf": [
          {"title": "en colonnes", "const": "columns"},
          {"title": "en lignes", "const": "lines"}
        ]
      },
      "footerExtraLogos": {
        "type": "array",
        "title": "Logos supplémentaires",
        "items": {
          "type": "object",
          "properties": {
            "src": {"type": "string", "title": "URL de l'image"},
            "title": {"type": "string", "title": "intitulé"},
            "href": {"type": "string", "title": "URL du lien"}
          }
        }
      },
      "footerLinks": {
        "title": "Liens",
        "type" : "array",
        "items": {
          "type": "object",
          "oneOf": [{
            "title": "Page du portail",
            "properties": {
              "type": {
                "const": "internal"
              },
              "page":{
                "title": "Page",
                "type": "object",
                "x-fromUrl": "{context.portalUrl}/pages?size=1000",
                "x-itemsProp": "results",
                "x-itemTitle": "title",
                "x-itemKey": "id",
                "properties": {
                  "title": {
                    "type": "string"
                  },
                  "id": {
                    "type": "string"
                  }
                }
              }
            }
          },{
            "title": "Lien externe",
            "properties": {
              "type": {
                "const": "external"
              },
              "title": {
                "title": "Libellé du lien",
                "type": "string"
              },
              "href": {
                "title": "URL",
                "type": "string"
              }
            }
          }],
          "default": {
            "type": "internal"
          }
        },
        "default": []
      },
      "footerImportantLinks": {
        "title": "Liens importants",
        "type" : "array",
        "items": {
          "type": "object",
          "oneOf": [{
            "title": "Page du portail",
            "properties": {
              "type": {
                "const": "internal"
              },
              "page":{
                "title": "Page",
                "type": "object",
                "x-fromUrl": "{context.portalUrl}/pages?size=1000",
                "x-itemsProp": "results",
                "x-itemTitle": "title",
                "x-itemKey": "id",
                "properties": {
                  "title": {
                    "type": "string"
                  },
                  "id": {
                    "type": "string"
                  }
                }
              }
            }
          },{
            "title": "Lien externe",
            "properties": {
              "type": {
                "const": "external"
              },
              "title": {
                "title": "Libellé du lien",
                "type": "string"
              },
              "href": {
                "title": "URL",
                "type": "string"
              }
            }
          }],
          "default": {
            "type": "internal"
          }
        },
        "default": []
      }
    }
  }, {
    "title": "Page d'accueil",
    "properties": {
      "homeImageAsBanner": {
        "type": "boolean",
        "title": "Image principale en bannière",
        "default": false
      },
      "homeReuse": {
        "title": "Remplacer l'image principale par une visualisation",
        "type": "object",
        "x-fromUrl": "{context.dataFairUrl}/api/v1/applications?q={q}&owner={context.owner}&size=1000",
        "x-itemsProp": "results",
        "x-itemTitle": "title",
        "x-itemKey": "href",
        "properties": {
          "href": {
            "type": "string"
          },
          "title": {
            "type": "string"
          },
          "id": {
            "type": "string"
          }
        }
      },
      "description": {
        "type": "string",
        "maxLength": 50000,
        "description": "Vous pouvez saisir du contenu riche au format HTML et/ou markdown.",
        "default": "Bienvenue sur notre portail de données. Vous y trouverez tous les jeux de données que nous avons retravaillé et publiés, ainsi que des visualisations qui permettent de mieux comprendre les données.\n\nLes pages sur les jeux de données et sur les visualisations disposent de moteurs de recherche et de filtres pour trouver plus facilement les données. Les données sont présentées et mises en valeur par des visualisations interactives. On peut également les consulter via un tableau, les télécharger ou les manipuler à l'aide de l'API.\n\nLes visualisations interactives permettent de naviguer dans des données volumineuses, sans avoir besoin de savoir programmer. Il est possible de visualiser des agrégations de millions de lignes dans des graphiques interactifs et d'explorer des cartes qui présentent de gros volumes d'information tout en offrant une navigation très fluide."
      },
      "showKpis": {
        "title": "Afficher les chiffres clés",
        "type": "boolean",
        "default": true
      },
      "showTopics": {
        "title": "Afficher les thématiques",
        "type": "boolean",
        "default": true
      },
      "featuredReuse": {
        "title": "Visualisation mise en avant",
        "type": "object",
        "x-fromUrl": "{context.dataFairUrl}/api/v1/applications?q={q}&owner={context.owner}&size=1000",
        "x-itemsProp": "results",
        "x-itemTitle": "title",
        "x-itemKey": "href",
        "properties": {
          "href": {
            "type": "string"
          },
          "title": {
            "type": "string"
          },
          "id": {
            "type": "string"
          }
        }
      },
      "homeDatasets": {
        "type": "object",
        "title": "Liste réduite de jeux de données",
        "default": {
          "type": "none"
        },
        "oneOf": [{
          "title": "Ne rien afficher",
          "properties": {
            "type": {
              "const": "none"
            }
          }
        }, {
          "title": "Afficher les derniers",
          "properties": {
            "type": {
              "const": "lasts"
            },
            "size":{
              "title": "Nombre d'éléments",
              "type": "integer",
              "default": 3
            }
          }
        }]
      },
      "homeReuses": {
        "type": "object",
        "title": "Liste réduite de visualisations",
        "default": {
          "type": "none"
        },
        "oneOf": [{
          "title": "Ne rien afficher",
          "properties": {
            "type": {
              "const": "none"
            }
          }
        }, {
          "title": "Afficher les dernières",
          "properties": {
            "type": {
              "const": "lasts"
            },
            "size":{
              "title": "Nombre d'éléments",
              "type": "integer",
              "default": 3
            }
          }
        }]
      }
    }
  }, {
    "title": "Contenu",
    "required": ["title"],
    "properties": {
      "datasetsPage": {
        "type": "object",
        "title": "Page des jeux de données",
        "default": {
          "type": "infiniteScroll"
        },
        "oneOf": [{
          "title": "Liste avec scroll infini",
          "properties": {
            "type": {
              "const": "infiniteScroll"
            }
          }
        },{
          "title": "Ne rien afficher",
          "properties": {
            "type": {
              "const": "none"
            }
          }
        }]
      },
      "reusesPage": {
        "type": "object",
        "title": "Page des réutilisations",
        "default": {
          "type": "infiniteScroll"
        },
        "oneOf": [{
          "title": "Liste avec scroll infini",
          "properties": {
            "type": {
              "const": "infiniteScroll"
            }
          }
        },{
          "title": "Ne rien afficher",
          "properties": {
            "type": {
              "const": "none"
            }
          }
        }]
      }
    }
  }, {
    "title": "Communication & contact",
    "properties": {
      "twitter": {
        "type": "string",
        "title": "Compte Twitter"
      },
      "facebook": {
        "type": "string",
        "title": "Compte Facebook"
      },
      "linkedin": {
        "type": "string",
        "title": "Compte LinkedIn"
      },
      "youtube": {
        "type": "string",
        "title": "Identifiant chaîne Youtube"
      },
      "instagram": {
        "type": "string",
        "title": "Compte Instagram"
      },
      "contactEmail": {
        "type": "string",
        "title": "Email de contact",
        "format": "email",
        "description": "Cet email ne sera pas directement exposé aux utilisateurs, mais un formulaire de contact sera disponible dans le portail."
      },
      "contactInfos": {
        "type": "string",
        "title": "Informations de contact",
        "maxLength": 10000
      }
    }
  }, {
    "title": "Suivi d'activité",
    "description": "Configurez un système de suivi d'activité des utilisateurs (Web analytics).",
    "properties": {
      "analytics": {
        "type": "object",
        "default": {
          "type": "none"
        },
        "oneOf": [{
          "title": "Aucun suivi",
          "properties": {
            "type": {
              "const": "none"
            }
          }
        }, {
          "title": "Matomo (anciennement Piwik)",
          "properties": {
            "type": {
              "const": "matomo",
              "title": "Type de système"
            },
            "params": {
              "type": "object",
              "properties": {
                "trackerBase": {
                  "type": "string",
                  "title": "URL du tracker"
                },
                "siteId": {
                  "type": "string",
                  "title": "Identifiant du site"
                }
              }
            },
            "anonymized": {
              "type": "boolean",
              "title": "Système configuré en mode anonyme",
              "description": "Cochez cette case si votre système de suivi des utilisateurs est configuré pour anonymiser les identifiants personnels des utilisateurs (adresses IPs). Si c'est le cas le portail n'affichera pas de bandeau avertissant l'utilisateur que le site utilise des cookies de suivi."
            }
          }
        }, {
          "title": "Google Analytics (ancien mode Universal Analytics)",
          "properties": {
            "type": {
              "const": "ga",
              "title": "Type de système"
            },
            "params": {
              "type": "object",
              "properties": {
                "trackingId": {
                  "type": "string",
                  "title": "Identifiant du tracker"
                },
                "appName": {
                  "type": "string",
                  "title": "Nom de l'application"
                },
                "appVersion": {
                  "type": "string",
                  "title": "Version de l'application"
                }
              }
            },
            "anonymized": {
              "const": "false",
              "title": "Système configuré en mode anonyme"
            }
          }
        }, {
          "title": "Google Analytics (nouveau mode Global site tag)",
          "properties": {
            "type": {
              "const": "gtag"
            },
            "params": {
              "type": "object",
              "properties": {
                "measurementId": {
                  "type": "string",
                  "title": "Identifiant de mesure",
                  "description": "Trouvez cet identifiant dans l'interface de Google Analytics > Administration > Assistant de configuration > Installation de la balise"
                }
              }
            },
            "anonymized": {
              "const": "false",
              "title": "Système configuré en mode anonyme"
            }
          }
        }]
      }
    }
  }]
}
