{
  "type": "object",
  "x-display": "expansion-panels",
  "x-options": {
    "expansionPanelsProps": {
      "multiple": true,
      "accordion": true,
      "value": [0, 1, 2, 3]
    }
  },
  "allOf": [{
    "title": "Propriétaire du portail",
    "properties": {
      "owner": {
        "type": "object",
        "additionalProperties": false,
        "required": ["id"],
        "properties": {
          "id": {
            "type": "string",
            "description": "The unique id of the user or organization"
          },
          "name": {
            "type": "string",
            "description": "The display name of the user or organization"
          }
        },
        "x-fromUrl": "{context.directoryUrl}/api/organizations?q={q}&size=1000",
        "x-itemsProp": "results",
        "x-itemTitle": "name",
        "x-itemKey": "id"
      }
    }
  }, {
    "title": "Présentation",
    "required": ["themeColor", "footerColor"],
    "properties": {
      "themeColor": {
        "type": "string",
        "default": "#1E88E5",
        "title": "Couleur principale",
        "format": "hexcolor",
        "x-display": "color-picker"
      },
      "footerColor": {
        "type": "string",
        "default": "#424242",
        "title": "Couleur du footer",
        "format": "hexcolor",
        "x-display": "color-picker"
      }
    }
  }, {
    "title": "Contenu",
    "required": ["title", "description"],
    "properties": {
      "title": {
        "type": "string",
        "default": "Portail de données"
      },
      "description": {
        "type": "string",
        "maxLength": 50000,
        "description": "Vous pouvez saisir du contenu riche au format HTML et/ou markdown.",
        "default": "Bienvenue sur notre portail de données. Vous y trouverez tous les jeux de données que nous avons retravaillé et publiés, ainsi que des visualisations qui permettent de mieux comprendre les données.\n\nLes pages sur les jeux de données et sur les visualisations disposent de moteurs de recherche et de filtres pour trouver plus facilement les données. Les données sont présentées et mises en valeur par des visualisations interactives. On peut également les consulter via un tableau, les télécharger ou les manipuler à l'aide de l'API.\n\nLes visualisations interactives permettent de naviguer dans des données volumineuses, sans avoir besoin de savoir programmer. Il est possible de visualiser des agrégations de millions de lignes dans des graphiques interactifs et d'explorer des cartes qui présentent de gros volumes d'information tout en offrant une navigation très fluide."
      },
      "showKpis": {
        "title": "Afficher les chiffres clés",
        "type": "boolean",
        "default": true
      },
      "featuredReuse": {
        "title": "Visualisation mise en avant",
        "type": "object",
        "x-fromUrl": "{context.dataFairUrl}/api/v1/applications?q={q}&owner=organization:{context.owner}&size=1000",
        "x-itemsProp": "results",
        "x-itemTitle": "title",
        "x-itemKey": "href",
        "properties": {
          "href": {
            "type": "string"
          },
          "title": {
            "type": "string"
          },
          "id": {
            "type": "string"
          }
        }
      },
      "homeDatasets": {
        "type": "object",
        "title": "Jeux de données page d'accueil",
        "default": {
          "type": "none"
        },
        "oneOf": [{
          "title": "Ne rien afficher",
          "properties": {
            "type": {
              "const": "none"
            }
          }
        }, {
          "title": "Afficher les derniers",
          "properties": {
            "type": {
              "const": "lasts"
            }
          }
        }]
      },
      "homeReuses": {
        "type": "object",
        "title": "Visualisations page d'accueil",
        "default": {
          "type": "none"
        },
        "oneOf": [{
          "title": "Ne rien afficher",
          "properties": {
            "type": {
              "const": "none"
            }
          }
        }, {
          "title": "Afficher les dernières",
          "properties": {
            "type": {
              "const": "lasts"
            }
          }
        }]
      },
      "datasetsPage": {
        "type": "object",
        "title": "Page des jeux de données",
        "default": {
          "type": "infiniteScroll"
        },
        "oneOf": [{
          "title": "Liste avec scroll infini",
          "properties": {
            "type": {
              "const": "infiniteScroll"
            }
          }
        },{
          "title": "Ne rien afficher",
          "properties": {
            "type": {
              "const": "none"
            }
          }
        }]
      },
      "reusesPage": {
        "type": "object",
        "title": "Page des réutilisations",
        "default": {
          "type": "infiniteScroll"
        },
        "oneOf": [{
          "title": "Liste avec scroll infini",
          "properties": {
            "type": {
              "const": "infiniteScroll"
            }
          }
        },{
          "title": "Ne rien afficher",
          "properties": {
            "type": {
              "const": "none"
            }
          }
        }]
      }
    }
  }, {
    "title": "Communication",
    "properties": {
      "website": {
        "type": "string",
        "title": "Site web"
      },
      "email": {
        "type": "string",
        "title": "Email de contact"
      },
      "twitter": {
        "type": "string",
        "title": "Compte twitter"
      },
      "cgu": {
        "type": "string",
        "title": "Page des CGU"
      },
      "contact": {
        "type": "string",
        "title": "Page de contact"
      }
    }
  }, {
    "title": "Suivi d'activité",
    "description": "Configurez un système de suivi d'activité des utilisateurs (Web analytics).",
    "properties": {
      "analytics": {
        "type": "object",
        "default": {
          "type": "none"
        },
        "oneOf": [{
          "title": "Aucun suivi",
          "properties": {
            "type": {
              "const": "none"
            }
          }
        }, {
          "title": "Matomo (anciennement Piwik)",
          "properties": {
            "type": {
              "const": "matomo",
              "title": "Type de système"
            },
            "params": {
              "type": "object",
              "properties": {
                "trackerBase": {
                  "type": "string",
                  "title": "URL du tracker"
                },
                "siteId": {
                  "type": "string",
                  "title": "Identifiant du site"
                }
              }
            },
            "anonymized": {
              "type": "boolean",
              "title": "Système configuré en mode anonyme",
              "description": "Cochez cette case si votre système de suivi des utilisateurs est configuré pour anonymiser les identifiants personnels des utilisateurs (adresses IPs). Si c'est le cas le portail n'affichera pas de bandeau avertissant l'utilisateur que le site utilise des cookies de suivi."
            }
          }
        }, {
          "title": "Google Analytics",
          "properties": {
            "type": {
              "const": "ga",
              "title": "Type de système"
            },
            "params": {
              "type": "object",
              "properties": {
                "trackingId": {
                  "type": "string",
                  "title": "Identifiant du tracker"
                },
                "appName": {
                  "type": "string",
                  "title": "Nom de l'application"
                },
                "appVersion": {
                  "type": "string",
                  "title": "Version de l'application"
                }
              }
            },
            "anonymized": {
              "const": "false",
              "title": "Système configuré en mode anonyme"
            }
          }
        }]
      }
    }
  }]
}
